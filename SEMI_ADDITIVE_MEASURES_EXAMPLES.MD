# SEMI ADDITIVE MEASURES

* ADDITIVE ACROSS SOME DIMENSIONS, BUT NOT ALL, FOR EXAMPLE TIME

* CASE: ACCOUNT BALANCES, STOCK PRICES, AND INVENTORY BALANCES

KEY FUNCTIONS IN CONJUCTION WITH CALCULATE:

* FIRSTDATE

* LASTDATE

* FIRSTNONBLANK	

* LASTNONBLANK

	EXAMPLE, MONTH ENDING ON A SATURDAY, BRINGS BACK THE LASTNONBLANK

* NOTE: IF THERE ARE GAPS IN THE DATA, EXAMPLE NO DATA ON THE WEEKENDS, THERE WILL BE GAPS OR BLANKS WHEN
	USING FIRSTDATE OR LASTDATE, TO COUNTER THIS DAX BEHAVIOR, USE FIRSTNONBLANK OR LASTNONBLANK IN SUCH INSTANCES

## FIRSTDATE

	CLOSE PRICE BEGINNING OF THE MONTH = 
	CALCULATE(
		[Close Price],
		FIRSTDATE('Date'[Date])) 

## LASTDATE

	CLOSE PRICE END OF MONTH = 
	CALCULATE(
		[Close Price],
		LASTDATE('Date'[Date])) 

## FIRSTNONBLANK

	CLOSE PRICE BOM NON BLANK = 
	CALCULATE(
		[Close Price],
		FIRSTNONBLANK('Date'[Date],[Close Price])) 


## LASTNONBLANK

	CLOSE PRICE EOM NON BLANK = 
	CALCULATE(
		[Close Price],
		LASTNONBLANK('Date'[Date],[Close Price])) 


## OPENING BALANCES

* RETURNS OPENING BALANCE REGARDLESS OF THE FILTER

* CAN PUT THE BALANCES AT EACH LEVEL ON ONE ROW IN THE REPORT

* CAVEAT TO USING THESE FUNCTIONS, THEY DO NOT HANDLE GAPS IN DATA

OPENINGBALANCEMONTH

OPENINGBALANCEQUARTER

OPENINGBALANCEYEAR

## CLOSING BALANCES

CLOSINGBALANCEMONTH

CLOSINGBALANCEQUARTER

CLOSINGBALANCEYEAR

## CALCULATETABLE

* THIS GETS AROUND THE CAVEAT OF WHEN OPENING OR CLOSING FUNCTIONS HAVE GAPS IN DATA

* USE IN CONJUCTION WITH THE PARALLELPERIOD AND LASTNONBLANK FUNCTION

* THIS IS A CUSTOM SOLUTION, BUT WORKS BETTER IN REAL WORLD EXAMPLES AT WORK

SYNTAX:

* TAKE A TABLE

* CHANGE THE FILTER CONTEXT

* AND USE IN OTHER PARAMETERS


	CALCULATETABLE(
		EXPRESSION,
		<FILTER>
		)

EXAMPLE:

	CLOSE PRICE EOM - CBM CALCULATETABLE = 
	CALCULATE(
		[Close Price],
		CALCULATETABLE(
			'Date',
			LASTNONBLANK(
			PARALLELPERIOD(
				'Date'[Date],
				0,
				MONTH),
				[Close Price])))
	
* USE CALCULATE FOR THE CLOSE PRICE EXPRESSION

* CHANGE THE FILTER CONTEXT BY USING CALCULATE TABLE ON THE DATE TABLE

* WE WANT THE LASTNONBLANK VALUE OF THE [CLOSING PRICE]

* THE TABLE WE WANT TO BRING BACK IS THE CURRENT MONTH OF THE FILTER CONTEXT FOR THE LASTNONBLANK FUNCTION
	SO THE PARALLELPERIOD FUNCTION IS USED TO BRING BACK THE CURRENT MONTH AT THE DAY LEVEL,
	0 IS ENTERED FOR THE CURRENT MONTH AND CLOSE PRICE IS THE EXPRESSION WE ARE USING


OPENINGBALANCE

EXAMPLE:

	OPENINGPRICE

	CLOSE PRICE EOM - CBM CALCULATETABLE = 
	CALCULATE(
		[Close Price],
		CALCULATETABLE(
			'Date',
			LASTNONBLANK(
			PARALLELPERIOD(
				'Date'[Date],
				-1,
				MONTH),
				[Close Price])))

* SIMILAR TO THE ABOVE CALCULATION, EXCEPT, GRAB THE LAST NON BLANK FROM THE PREVIOUS MONTH


* Scales best for big tables (hundred million to billion >)

		CALCULATE(SUM(Facttable[columntosum] ),
				       All(datetable),
				       Filter(
					      All(datetable[CalendarDate]),
					      CONTAINS(
						       SUMMARIZE(ADDCOLUMNS( VALUES(datetable[CalendarDate]),"Date-1",MAX(datetable[CalendarDate])),
						       [Date-1]
						       ),
						       [Date-1],datetable[CalendarDate]
					      )
				       )
		)
